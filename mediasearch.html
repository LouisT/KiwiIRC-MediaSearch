<!-- Use the latest version of Font Awesome! -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">

<script>
/*
  Kiwi IRC Media Search - By Louis T. < https://ltdev.im/ >

  [Required API Keys]
  500px:        https://500px.com/settings/applications
  Instagram:    https://www.instagram.com/developer/
  Last.fm:      http://www.last.fm/api
  SoundCloud:   http://soundcloud.com/you/apps
  Vimeo:        https://developer.vimeo.com/apps
  YouTube:      https://developers.google.com/youtube/v3/getting-started
*/
var MediaSearch = {
    // API settings, object key is the 'Font Awesome' value.
    // NOTE: Any service listed above requires an API key.
    apis: {
       '500px': {
           // Search by default?
           status: false,
           // Service name.
           name: '500px',
           // API key is required.
           apikey: '',
           // Usable search provider?
           enabled: false
       },
       instagram: {
           status: false,
           name: 'Instagram',
           apikey: '',
           enabled: false
       },
       lastfm: {
           status: false,
           name: 'Last.fm',
           apikey: '',
           enabled: false
       },
       mixcloud: {
           status: false,
           name: 'Mixcloud',
           enabled: true
       },
       soundcloud: {
           status: false,
           name: 'SoundCloud',
           apikey: '',
           enabled: false
       },
       spotify: {
           status: true,
           name: 'Spotify',
           enabled: true
       },
       'stack-overflow': {
           status: false,
           name: 'Stack Overflow',
           enabled: true
       },
       twitch: {
           status: false,
           name: 'Twitch',
           enabled: true
       },
       vimeo: {
           status: true,
           name: 'Vimeo',
           apikey: 'false',
           enabled: false
       },
       youtube: {
           status: true,
           name: 'YouTube',
           apikey: '',
           enabled: false
       }
    },

    // Autocomplete in the search input.
    autocomplete: {
        // Use auto complete from Bing?
        enabled: true,
        // How fast to update the suggestions.
        speed: 500,
    },

    // Number of results to display; Calculated default: ~~(max - (max - min) / 2)
    limit: {
        min: 5,
        max: 50,
    },

    // Required 3rd party libraries.
    libraries: [
        'https://apis.google.com/js/client.js',
        'https://platform.instagram.com/en_US/embeds.js'
    ],

    // A 1px image placeholder.
    placeholder: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'
}
</script>
<style>
    #kiwi .ms-wrapper {
        color: white;
        position: absolute;
        background: #3c3b37;
        padding: 5px;
        width: 35%;
        height: 45%;
        min-width: 383px;
        min-height: 300px;
        overflow: hidden;
        border-top-left-radius: 8px;
        max-width: 509px;
        z-index: 100;
    }
    #kiwi .ms-wrapper .close {
        float: right;
    }
    #kiwi .ms-wrapper .menu {
        cursor: pointer;
        padding: 5px;
    }
    #kiwi .ms-wrapper .menu:hover {
        color: #88C56A;
    }
    #kiwi .ms-wrapper .msin {
        width: 50%;
    }
    #kiwi .ms-wrapper hr {
        margin: 5px;
    }
    #kiwi .ms-wrapper .break {
        margin: 0;
        margin-top: 5px;
        margin-bottom: 5px;
        color: black;
    }
    #kiwi .ms-wrapper .list {
        padding-bottom: 5px;
        overflow-y: scroll;
        z-index: -5;
        height: 88%;
        overflow-x: hidden;
    }
    #kiwi .ms-wrapper .list .thumbnail {
        width: 120px;
        height: 90px;
        position: relative;
        margin-right: 5px;
        margin-bottom: 5px;
        cursor: pointer;
    }
    #kiwi .ms-wrapper .list .thumbnail img {
        background-color: #949993;
        width: 120px;
        height: 90px;
    }
    #kiwi .ms-wrapper .list .thumbnail .icon {
        position: absolute;
        bottom: 0;
        left: 0;
        margin-bottom: 3px;
        color: #88C56A;
        background-color: rgba(0,0,0,0.7);
        width: auto;
        padding: 5px;
    }
    #kiwi .ms-wrapper .list .toggle {
        margin: 5px !important;
    }
    #kiwi .ms-wrapper .list .toggle:hover {
        cursor: pointer;
    }
    #kiwi .ms-wrapper .list .share {
        float: right;
        display: inline-block;
        padding-right: 5px;
    }
    #kiwi .ms-wrapper .list h4 {
        margin-bottom: 0px;
        font-size: 18px;
        width: 50%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
    }
    #kiwi .ms-wrapper .date {
        font-size: 10px;
        float: right;
        margin-right: 10px;
    }
    #kiwi .ms-wrapper .list div {
        width: 100%;
        display: inline-block;
    }
    #kiwi .ms-wrapper .list .ms-providers {
        width: 60%;
    }
    #kiwi .ms-wrapper .list #ms-limit {
        background: transparent none repeat scroll 0% 0%;
        color: rgb(148, 153, 147);
        -webkit-box-shadow: none;
        box-shadow: none;
        font-size: 35px;
        width: 15%;
    }
    #kiwi .ms-wrapper .list .tooltip:hover:after {
        font-size: 16px;
        border: 1px solid;
        padding: 6px;
        margin-bottom: 0px;
        background: #000;
        background: rgba(0,0,0,.85);
        content: attr(data-title);
        position: fixed;
        bottom: 0;
        right: 0;
        z-index: 1000;
     }
</style>
<script>
(function (global, $MS, undefined) {
    // Load required 3rd party libraries.
    $.each($MS.libraries, function (idx, link) {
       $.getScript(link);
    });

    var mediabox = $($('#tmpl_mediasearch').html()).hide().appendTo($('#kiwi')),
        control = kiwi.components.ControlInput(),
        area =  $('#kiwi .controlbox textarea');
    $MS.__requests = [];
    $MS.limit.current = ~~($MS.limit.max - ($MS.limit.max - $MS.limit.min) / 2);
    control.addPluginIcon($('<a title="Media Search"><i class="fa fa-search"></i></a>').click(function () {
        mediabox.show().css({bottom: ($('.controlbox').outerHeight())+'px', right: 0});
    }));
    if ($MS.apis.youtube.status) {
       $MS.apis.youtube.status = false;
       $MS.apis.youtube.__trigger = true;
    }
    (function hasGapi (gapiCounter) {
        if (gapiCounter++ >= 100) {
           console.log('Failed to load gapi! "YTS" plugin nonfunctional.');
         } else if (global['gapi'] && global['gapi'].client) {
           global['gapi'].client.setApiKey($MS.apis.youtube.apikey);
           global['gapi'].client.load("youtube", "v3", function () {
               if ($MS.apis.youtube.__trigger) {
                  $MS.apis.youtube.status = true;
                  $('.ms-wrapper .list .toggle.fa-youtube').css('color','#88C56A');
               }
           });
        } else { setTimeout(function () { hasGapi(gapiCounter); }, 200); };
    })(0);
    $(global).resize(function () {
        mediabox.hide();
    });
    $('.ms-wrapper .undo').click(function () {
        $('.ms-wrapper .msin').val('');
        $('.ms-wrapper .list').html('');
    });
    $('.ms-wrapper .close').click(function () {
        mediabox.hide();
        $('.ms-wrapper .undo').click();
    });
    $('.ms-wrapper .msin').keyup(function (event) {
        if (event.keyCode === 13) {
           $('.ms-wrapper .search').click();
        }
    });
    $.each(_.keys($MS.apis), function (idx, key) {
        if (!$MS.apis[key].enabled) {
           $MS.apis[key].status = false;
        }
    });
    $('.ms-wrapper .settings').click(function () {
        abortRequests();
        $('.ms-wrapper .list').html([
            '<center><h4>Search Limit:</h4><br /><input type="number" id="ms-limit" min="', $MS.limit.min,
            '" max="', $MS.limit.max, '" step="1" value="', $MS.limit.current, '">',
            '<br /><h4>Search Providers</h4><br /><div class="ms-providers"></div></cemnter>'
        ].join(''));
        $('#ms-limit').bind('click keyup', function (e) {
            var elm = $(this),
                val = elm.val(),
                min = $MS.limit.min,
                max = $MS.limit.max;
            if ($MS._timer) {
               clearTimeout($MS._timer);
            }
            if (e.keyCode && e.keyCode !== 8 && val.length === 0) {
               $MS.limit.current = ~~(max - (max-min)/2);
               return elm.val($MS.limit.current);
            }
            $MS._timer = setTimeout(function () {
               if (!elm.val() || elm.val() === val) {
                  $MS.limit.current = Number(val>max?max:(val<min?min:val));
                  elm.val($MS.limit.current);
               }
            }, (val?500:5000));
        });
        $.each(_.keys($MS.apis), function (index, key) {
            var obj = $MS.apis[key];
            if (obj.enabled) {
               var elm = $('<i class="tooltip toggle fa fa-'+key+' fa-3x" data-title="'+obj.name+'"></i>');
               elm.click(function () {
                   obj.status = !obj.status;
                   $(this).css('color',(obj.status?'#88C56A':'#949993'));
               }).css('color',(obj.status?'#88C56A':'#949993'));
               $('.ms-providers').append(elm);
            }
        });
    });
    if (!$MS.autocomplete.enabled) {
       console.log('Autocomplete is not enabled!');
     } else if (!('options' in document.createElement('datalist'))) {
       console.log('Browser does not support datalist; Can not use Autocomplete!');
     } else {
       $('.ms-wrapper .msin').keyup(_.debounce(function (event) {
           if (event.keyCode !== 13) {
              var val = $('.ms-wrapper .msin').val();
              if ((!val || 0 === val.length || /^\s*$/.test(val))) {
                 return;
              }
              abortRequests();
              $MS.__requests.push($.ajax({
                  url: ['https://api.bing.com/osjson.aspx?query=', val, '&JsonType=callback&JsonCallback=?'].join(''),
                  dataType: 'jsonp',
               }).done(function (data) {
                  var dataset = $('.ms-wrapper #MediaSearch').empty();
                  $.map(data[1], function (item) {
                      dataset.append($('<option value="'+item+'">'));
                  });
                  dataset.append($('<option />'));
              }));
           }
       }, ($MS.autocomplete.speed||500)));
    }
    $('.ms-wrapper .search').click(function () {
        abortRequests();
        $('.ms-wrapper #MediaSearch').empty();
        $('.ms-wrapper .list').empty();
        var val = $('.ms-wrapper .msin').val();
        if (!_.some(_.keys($MS.apis), function (key) { return $MS.apis[key].status; })) {
           return $('.ms-wrapper .list').html('<center>Please enable a search provider in options.</center>');
         } else if ((!val || 0 === val.length || /^\s*$/.test(val))) {
           return $('.ms-wrapper .list').html('<center>Search must not be empty.</center>');
        }

        // 500px
        if ($MS.apis['500px'].status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.500px.com/v1/photos/search?term=', encodeURIComponent(val), '&consumer_key=', $MS.apis['500px'].apikey,
                     '&rpp=', $MS.limit.current].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.photos && json.photos.length >= 1) {
                  var html = [];
                  $.each(json.photos, function (index, item) {
                      if (item.url) {
                         var link = ['https://500px.com',item.url].join(''),
                             img = (item.image_url||$MS.placeholder);
                         html.push([
                             '<span class="thumbnail 500px tooltip" data-title="', $('<div />').html(item.description||'N/A').text(), '" data-link="', link,
                             '"><img src="', img, '" /><div class="icon"><i class="fa fa-500px fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('500px', html);
                } else {
                  onFailure('500px')();
               }
           }).fail(onFailure('500px')));
        }

        // Instagram
        if ($MS.apis.instagram.status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.instagram.com/v1/tags/', val.replace(/[^a-z0-9]+/gi,''), '/media/recent?count=',
                     $MS.limit.current, '&access_token=', $MS.apis.instagram.apikey, '&callback=?'].join(''),
               dataType: 'jsonp',
            }).done(function (json) {
               if (json.data && json.data.length >= 1) {
                  var html = [];
                  $.each(json.data, function (index, item) {
                      if (item.link) {
                         var img = (item.images && item.images.thumbnail.url?item.images.thumbnail.url:$MS.placeholder);
                         html.push([
                             '<span class="thumbnail instagram tooltip" data-title="', (item.caption.text||'N/A'), '" data-link="', item.link,
                             '"><img src="', img, '" /><div class="icon"><i class="fa fa-instagram fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('instagram', html);
                } else {
                  onFailure('Instagram')();
               }
           }).fail(onFailure('Instagram')));
        }

        // Last.fm
        if ($MS.apis.lastfm.status) {
           $MS.__requests.push($.ajax({
               url: ['https://ws.audioscrobbler.com/2.0/?method=track.search&track=', encodeURIComponent(val), '&api_key=', $MS.apis.lastfm.apikey,
                     '&limit=', $MS.limit.current, '&format=json'].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.results && json.results.trackmatches && json.results.trackmatches.track && json.results.trackmatches.track.length >= 1) {
                  var html = [];
                  $.each(json.results.trackmatches.track, function (index, item) {
                      if (item.url) {
                         var img = $MS.placeholder,
                             arr = item.image.reverse();
                         for (var idx in arr) {
                             if (!(!arr[idx]['#text'] || 0 === arr[idx]['#text'].length)) {
                                img = arr[idx]['#text'];
                                break;
                             }
                         }
                         html.push([
                             '<span class="thumbnail lastfm tooltip" data-title="', item.name, ' - ', item.artist, '" data-link="', item.url,
                             '"><img src="', img, '" /><div class="icon"><i class="fa fa-lastfm fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('lastfm', html);
                } else {
                  onFailure('Last.fm')();
               }
           }).fail(onFailure('Last.fm')));
        }

        // Mixcloud
        if ($MS.apis.mixcloud.status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.mixcloud.com/search/?q=', encodeURIComponent(val), '&type=cloudcast&limit=', $MS.limit.current].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.data && json.data.length >= 1) {
                  var html = [];
                  $.each(json.data, function (index, item) {
                      if (item.url) {
                         var img = item.pictures[(item.pictures.medium?'medium':'large')]||$MS.placeholder;
                         html.push([
                             '<span class="thumbnail mixcloud tooltip" data-title="', item.name, '" data-link="', item.url,
                             '"><img src="', img, '" /><div class="icon"><i class="fa fa-mixcloud fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('mixcloud', html);
                } else {
                  onFailure('Mixcloud')();
               }
           }).fail(onFailure('Mixcloud')));
        }

        // SoundCloud
        if ($MS.apis.soundcloud.status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.soundcloud.com/tracks.json?q=', encodeURIComponent(val), '&limit=', $MS.limit.current,
                     '&client_id=', $MS.apis.soundcloud.apikey].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json && json.length >= 1) {
                  var html = [];
                  $.each(json, function (index, item) {
                      if (item.permalink_url) {
                         var img = item[(item.artwork_url?'artwork_url':'waveform_url')]||null;
                         html.push([
                             '<span class="thumbnail soundcloud tooltip" data-title="', item.title, '" data-link="', item.permalink_url,
                             '"><img src="', img, '" /><div class="icon"><i class="fa fa-soundcloud fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('soundcoud', html);
                } else {
                  onFailure('SoundCloud')();
               }
           }).fail(onFailure('SoundCloud')));
        }

        // Spotify
        if ($MS.apis.spotify.status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.spotify.com/v1/search?q=', encodeURIComponent(val), '&type=track&limit=', $MS.limit.current].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.tracks && json.tracks.items.length >= 1) {
                  var html = [];
                  $.each(json.tracks.items, function (index, item) {
                      if (item.external_urls.spotify) {
                         var title = (item.artists?item.artists[0].name+' - ':'')+(item.name?item.name:'...'),
                             img = item.album.images.sort(function(a, b) {
                                 return a.width - b.width;
                             })[0].url||$MS.placeholder;
                         html.push([
                             '<span class="thumbnail spotify tooltip" data-title="', title, '" data-link="',
                             item.external_urls.spotify, '"><img src="', img, '" />',
                             '<div class="icon"><i class="fa fa-spotify fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('spotify', html);
                } else {
                  onFailure('Spotify')();
               }
           }).fail(onFailure('Spotify')));
        }

        // Stack Overflow
        if ($MS.apis['stack-overflow'].status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.stackexchange.com/2.2/search?order=desc&sort=activity&intitle=',
                     encodeURIComponent(val), '&site=stackoverflow&pagesize=', $MS.limit.current].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.items && json.items.length >= 1) {
                  var html = [];
                  $.each(json.items, function (index, item) {
                      if (item.link) {
                         var title = [
                                 item.owner.display_name, ' asked: ', item.title, ' (', (item.is_answered?'answered '+item.answer_count+' times':'unanswered'), ')'
                             ].join(''),
                             link = (item.accepted_answer_id?'https://stackoverflow.com/a/'+item.accepted_answer_id:item.link),
                             img = (item.owner.profile_image||$MS.placeholder);
                         html.push([
                             '<span class="thumbnail stack-overflow tooltip" data-title="', title, '" data-link="', link, '"><img src="',
                             img, '" /><div class="icon"><i class="fa fa-stack-overflow fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('stack-overflow', html);
                } else {
                  onFailure('Stack Overflow')();
               }
           }).fail(onFailure('Stack Overflow')));
        }

        // Twitch
        if ($MS.apis.twitch.status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.twitch.tv/kraken/search/channels?q=', encodeURIComponent(val), '&limit=', $MS.limit.current].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.channels && json.channels.length >= 1) {
                  var html = [];
                  $.each(json.channels, function (index, item) {
                      if (item.url) {
                         var title = item.display_name+' playing '+(item.game||'...'),
                             img = item[(item.video_banner?'video_banner':'logo')]||$MS.placeholder;
                         html.push([
                             '<span class="thumbnail twitch tooltip" data-title="', title, '" data-link="', item.url,
                             '"><img src="', img, '" /><div class="icon"><i class="fa fa-twitch fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('twitch', html);
                } else {
                  onFailure('Twitch')();
               }
           }).fail(onFailure('Twitch')));
        }

        // Vimeo
        if ($MS.apis.vimeo.status) {
           $MS.__requests.push($.ajax({
               url: ['https://api.vimeo.com/videos?query=', encodeURIComponent(val), '&per_page=', $MS.limit.current,
                     '&access_token=', $MS.apis.vimeo.apikey].join(''),
               dataType: 'json',
            }).done(function (json) {
               if (json.data && json.data.length >= 1) {
                  var html = [];
                  $.each(json.data, function (index, item) {
                      if (item.link) {
                         var img = item.pictures.sizes.sort(function(a, b) {
                                 return a.width - b.width;
                             })[0].link||$MS.placeholder;
                         html.push([
                             '<span class="thumbnail vimeo tooltip" data-title="', item.name, '" data-link="', item.link, '"><img src="',
                             img, '" /><div class="icon"><i class="fa fa-vimeo fa-2x"></i></div></span>'
                         ].join(''));
                      }
                  });
                  displayResults('vimeo', html);
                } else {
                  onFailure('Vimeo')();
               }
           }).fail(onFailure('Vimeo')));
        }

        // YouTube
        if ($MS.apis.youtube.status) {
           var req = global['gapi'].client.youtube.search.list({
               part: "snippet",
               type: "video",
               q: val,
               maxResults: $MS.limit.current,
               order: "viewCount"
           });
           req.abort = (function (req) {
               return function () {
                   req.__callback = req.__ABORT = $.noop;
               }
           })(req);
           $MS.__requests.push(req);
           req.__callback = function (res) {
               if (res.error || res.items.length <= 0) {
                  onFailure('YouTube')();
                } else {
                  var html = [];
                  $.each(res.result.items, function (index, item) {
                      var title = item.snippet.title,
                          vid = item.id.videoId;
                      html.push([
                          '<span class="thumbnail youtube tooltip" data-title="', title, '" data-link="https://youtu.be/',
                          vid, '"><img src="https://i.ytimg.com/vi/', vid, '/default.jpg" /><div class="icon"><i class="fa ',
                          'fa-youtube fa-2x"></i></div></span>'
                      ].join(''));
                  });
                  if (!req.__ABORT) {
                     displayResults('youtube', html);
                  }
               }
           };
           req.execute(function () { req.__callback.apply(this, arguments); });
        }
    });

    // Misc functions used throughout the plugin.
    function displayResults (provider, html) {
             $('.ms-wrapper .list').append(html.join(''));
             $('.ms-wrapper .list .thumbnail.'+provider).click(function () {
                 area.val(area.val().trim()+' '+$(this).data('link'));
             });
    }
    function abortRequests () {
             $MS.__requests = $.grep($MS.__requests, function (req) {
                 req.abort();
             });
    }
    function onFailure (provider) {
             return function (xhr, msg) {
                 if (!msg || !/^abort$/i.test(msg)) {
                    $('.ms-wrapper .list').prepend('<h6>No results from: '+provider+'</h6>');
                 }
             }
    }

    // Embed solutions for missing embeds.
    var embeds = [
        // Instagram has https://platform.instagram.com/en_US/embeds.js for managing embeds, this works better if we include it first.
        ['Instagram',/https?:\/\/(www.)?instagr\.?am(\.com)?\/p\/([a-z0-9]+)\/?/i,'https://api.instagram.com/oembed/?omitscript=true&callback=?&url=','rich',function (elm, data) {
            // Process Instagram embeds.
            (function insProccess () {
                if (global.instgrm) {
                   elm.replaceWith($(data.html));
                   global.instgrm.Embeds.process();
                } else { setTimeout(insProcess, 500); }
            })();
        }],
        ['Mixcloud',/https?:\/\/(www\.)?mixcloud.com\/(.[^\/]+)\/(.+)/i,'https://www.mixcloud.com/oembed/?callback=?&url=','rich'],
        ['Vimeo',/^https?:\/\/vimeo.com\/(\d+|\w+\/\w+)\/?/i,'https://vimeo.com/api/oembed.json?maxwidth=480&maxheight=270&url=','video'],
    ];
    $.each(embeds, function (index, embed) {
        kiwi.addMediaMessageType(function(url) {
            return embed[1].test(url);
         },function (url) {
            var elm = $('<i class="fa fa-spinner fa-spin fa-3x"></i>');

            // If it's not oEmbed, pull the content identifier to query an API.
            var url = (typeof embed[3] === 'function'?url.match(embed[1])[1]:url);

            $.getJSON(embed[2]+url).done(function (data) {
                if (typeof embed[3] !== 'function') {
                   if (data.type === embed[3] && data.html) {
                      if (embed[4] && typeof embed[4] === 'function') {
                         embed[4](elm, data);
                       } else {
                         elm.replaceWith($(data.html));
                      }
                    } else {
                      elm.replaceWith($('<h6>Invalid response from '+oembed[0]+'!</h6>'));
                   }
                 } else {
                   embed[3](embed, elm, data);
                }
             }).fail(function () {
                elm.replaceWith($('<h6>Could not connect to '+oembed[0]+'!</h6>'));
            });
            return elm;
        });
    });
})(window, window['MediaSearch']);
</script>
<script type="text/html" id="tmpl_mediasearch">
 <div class="ms-wrapper">
  <span class="header">
   <input class="msin" list="MediaSearch" placeholder="Media Search" />
   <i class="search menu fa fa-search"></i>
   <i class="undo menu fa fa-undo"></i>
   <i class="settings menu fa fa-cog"></i>
   <i class="close menu fa fa-times"></i><hr class="break" />
  </span>
  <div class="list"></div>
  <datalist id="MediaSearch"></datalist>
 </div>
</script>
